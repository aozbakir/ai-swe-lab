# RAG configuration

paths:
  input_file: "D:/Repos2/ELSA/input/pdf/metagpt.pdf"
  output_vectorstore_dir: "D:/Repos2/im2203/examples/rag-service-lab/faiss_index"

extraction:
  default: "pdfplumber"
  pypdf:
    mode: "single"
  pdfplumber: {}
    
chunking:
  default: "recursive"
  chunkers:
    character:
      chunk_size: 300
      chunk_overlap: 30
      separator: "" # can change to "\n\n" if you want paragraph splits
    recursive:
      chunk_size: 300
      chunk_overlap: 30
      separator: ["\n\n", "\n", " ", ""]

llm:
  default: "openai"
  openai:
    name: "openai"
    model_name: "gpt-3.5-turbo"
    base_url: null
    temperature: 0.0
  lmstudio:
    name: "lmstudio"
    model_name: "qwen2.5-7b-instruct-1m"
    base_url: "http://127.0.0.1:1234/v1"
    temperature: 0.0
    max_tokens: 512
    top_p: 0.1
    frequency_penalty: 0.0
    presence_penalty: 0.0
    request_timeout: 120
  huggingface:
    name: "huggingface"
    model_name: "meta-llama/Llama-2-7b-chat-hf"
    temperature: 0.3
    quantize_4bit: false
    max_new_tokens: 500
    top_k: 50
    top_p: 0.95

embeddings:
  default: sentence_transformers
  sentence_transformers:
    model_name: all-MiniLM-L6-v2
    device: cpu
    normalize_embeddings: true
    cache_dir: null
  openai:
    model_name: text-embedding-3-small
    base_url: null

vectorstore:
  default: "faiss"
  faiss:
    index_path: "D:/Repos2/im2203/examples/rag-service-lab/faiss_index/"

retrieval:
  default: "vectorstore"
  vectorstore:
    type: "FAISS"
    similarity_metric: "cosine"
    top_k: 5
    search_kwargs:
      score_threshold: 0.7  # Only get highly relevant chunks
      filter: null

generation:
  default: "openai"
  openai:
    model_ref: "llm.openai"
    prompt_template: "default"
    max_tokens: 500
    temperature: 0.2

prompts:
  default: "qa"
  qa:
    template: |
      You are a helpful AI assistant. Use the provided context to answer questions accurately.

      IMPORTANT INSTRUCTIONS:
      1. Base your answers solely on the provided context
      2. If the necessary information is not in the context, say "I don't find this information in the provided context"
      3. Do not make assumptions or use external knowledge
      4. Be precise and concise in your answers
      5. When relevant, cite specific parts of the context to support your answer

      Context:
      {context}

      Question: {query}

      Answer: